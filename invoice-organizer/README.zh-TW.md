# Invoice Organizer - 正體中文說明文件

## Skill 概述

### 功能
Invoice Organizer skill 自動整理發票和收據以準備報稅。它能讀取混亂的檔案、提取關鍵資訊、統一重新命名並分類到邏輯資料夾中。將數小時的手動記帳工作縮短為幾分鐘的自動化整理。

### 解決的問題
企業主和自由工作者在管理財務文件時常面臨以下挑戰：

1. **報稅準備耗時**：整理一年的發票需要數天時間
2. **檔案命名混亂**：「invoice.pdf」、「invoice(1).pdf」難以識別
3. **資訊難以提取**：需要手動開啟每個 PDF 查看內容
4. **分類不一致**：不知如何系統化分類支出
5. **缺少摘要報告**：難以快速了解支出概況
6. **會計師溝通困難**：提供的資料不夠結構化

這個 skill 將混亂的發票資料夾轉變為井然有序、報稅就緒的檔案系統。

---

## 目錄結構

```
invoice-organizer/
├── SKILL.md          # Skill 主要說明文件（英文）
└── README.zh-TW.md   # 正體中文說明文件（本文件）
```

---

## 核心功能分析

### 1. 讀取發票內容

**提取資訊**：
- 供應商/公司名稱
- 發票編號
- 日期
- 金額
- 產品或服務描述
- 付款方式

**支援格式**：
- PDF 發票
- 掃描收據（JPG、PNG）
- 電子郵件附件
- 螢幕截圖
- 銀行對帳單

### 2. 統一命名格式

**標準格式**：
```
YYYY-MM-DD 供應商 - Invoice - 產品或服務.pdf
```

**範例**：
```
2024-03-15 Adobe - Invoice - Creative Cloud.pdf
2024-01-10 Amazon - Receipt - Office Supplies.pdf
2023-12-01 Stripe - Invoice - Monthly Payment Processing.pdf
```

**命名最佳實踐**：
- 移除特殊字元（僅保留連字號）
- 正確大寫供應商名稱
- 簡潔但有意義的描述
- 一致的日期格式（YYYY-MM-DD）便於排序
- 保留原始副檔名

### 3. 按類別組織

**分類方式**：

**按供應商**：
```
Invoices/
├── Adobe/
├── Amazon/
├── Google/
└── Microsoft/
```

**按年份和類別（適合報稅）**：
```
Invoices/
├── 2023/
│   ├── Software/
│   ├── Hardware/
│   ├── Services/
│   └── Travel/
└── 2024/
    └── ...
```

**按季度**：
```
Invoices/
├── 2024/
│   ├── Q1/
│   │   ├── Software/
│   │   ├── Office/
│   │   └── Travel/
│   └── Q2/
```

**按稅務類別**：
```
Invoices/
├── Deductible/
│   ├── Software/
│   ├── Office/
│   └── Professional-Services/
├── Partially-Deductible/
│   └── Meals-Travel/
└── Personal/
```

### 4. 處理多種格式

**PDF 發票**：
- 使用文字提取讀取內容
- 尋找常見模式：
  - "Invoice Date:"、"Date:"、"Issued:"
  - "Invoice #:"、"Invoice Number:"
  - 公司名稱（通常在頂部）
  - "Amount Due:"、"Total:"、"Amount:"
  - "Description:"、"Service:"、"Product:"

**圖片收據**：
- 從圖片讀取可見文字
- 識別供應商名稱（通常在頂部）
- 尋找日期（常見格式）
- 找出總金額

**備用方案**：
- 使用檔名線索
- 檢查檔案建立/修改日期
- 如缺少關鍵資訊則標記需審查

### 5. 生成摘要報告

**建立 CSV 檔案**：
```csv
Date,Vendor,Invoice Number,Description,Amount,Category,File Path
2024-03-15,Adobe,INV-12345,Creative Cloud,52.99,Software,Invoices/2024/Software/Adobe/2024-03-15 Adobe - Invoice - Creative Cloud.pdf
2024-03-10,Amazon,123-4567890-1234567,Office Supplies,127.45,Office,Invoices/2024/Office/Amazon/2024-03-10 Amazon - Receipt - Office Supplies.pdf
```

**CSV 用途**：
- 匯入會計軟體
- 與會計師分享
- 支出追蹤和報告
- 報稅準備

### 6. 保留原始檔案

**安全性**：
- 複製檔案（不移動）以保留原始
- 或在移動前詢問使用者偏好
- 創建備份資料夾選項

---

## Claude Code 使用方式

### 觸發時機

Claude Code 會在以下情況使用此 Skill：

1. **報稅準備**
   ```
   整理這些發票以準備報稅
   ```

2. **基本使用**
   ```
   讀取此資料夾中的所有發票，重新命名為「YYYY-MM-DD 供應商 - Invoice - 產品.pdf」格式，並按供應商組織
   ```

3. **進階組織**
   ```
   整理這些發票：
   1. 從每個檔案提取日期、供應商和描述
   2. 重新命名為標準格式
   3. 按支出類別分類到資料夾（軟體、辦公室、差旅等）
   4. 建立包含所有發票詳情的 CSV 試算表給我的會計師
   ```

### 典型使用場景

#### 場景 1：報稅準備（來自 Martin Merschroth）

**使用者**：「我有一個亂七八糟的發票資料夾需要報稅。幫我分類並正確重新命名。」

**處理流程**：
1. 掃描資料夾：找到 147 個 PDF 和圖片
2. 讀取每張發票以提取：
   - 日期
   - 供應商名稱
   - 發票編號
   - 產品/服務描述
3. 重新命名所有檔案：`YYYY-MM-DD 供應商 - Invoice - 產品.pdf`
4. 組織到：`2024/Software/`、`2024/Travel/` 等
5. 建立 `invoice-summary.csv` 給會計師
6. 結果：幾分鐘內完成報稅就緒的發票整理

#### 場景 2：每月支出核對

**使用者**：「按類別整理我上個月的企業收據。」

**輸出**：
```markdown
# 2024 年 3 月收據已整理

## 按類別
- 軟體與工具：$847.32（12 張發票）
- 辦公用品：$234.18（8 張收據）
- 差旅與餐飲：$1,456.90（15 張收據）
- 專業服務：$2,500.00（3 張發票）

總計：$5,038.40

所有收據已重新命名並歸檔於：
`Business-Receipts/2024/03-March/[類別]/`

CSV 匯出：`march-2024-expenses.csv`
```

#### 場景 3：電子郵件下載清理

**使用者**：「我從 Gmail 下載發票。它們都命名為 'invoice.pdf'、'invoice(1).pdf' 等。整理這團混亂。」

**輸出**：
```markdown
找到 89 個全部命名為「invoice*.pdf」的檔案

正在讀取每個檔案以提取真實資訊...

重新命名範例：
- invoice.pdf → 2024-03-15 Shopify - Invoice - Monthly Subscription.pdf
- invoice(1).pdf → 2024-03-14 Google - Invoice - Workspace.pdf
- invoice(2).pdf → 2024-03-10 Netlify - Invoice - Pro Plan.pdf

所有檔案已重新命名並按供應商組織。
```

---

## 使用的 Prompt 策略

### 1. 詳細的步驟化流程

SKILL.md 提供完整的 7 步驟處理流程：
1. 掃描資料夾
2. 從每個檔案提取資訊
3. 確定組織策略
4. 建立標準化檔名
5. 執行組織
6. 生成摘要報告
7. 提供完成總結

### 2. 豐富的組織模式範例

提供 4 種常見組織結構：
- 按供應商
- 按年份和類別
- 按季度
- 按稅務類別

### 3. 實用的命令範例

每個步驟都有實際的 bash 命令示範。

### 4. 特殊情況處理

**資訊遺失**：
- 標記檔案需手動審查
- 使用檔案修改日期作為備用
- 建立「Needs-Review/」資料夾

**重複發票**：
- 比較檔案雜湊值
- 保留最高品質版本
- 在摘要中註記重複項

---

## 使用的工具（Tools）

此 Skill 主要依賴以下 Claude Code 工具：

### 1. **Read Tool**
- 讀取 PDF 文字內容
- 從圖片提取文字（OCR）
- 分析發票結構

### 2. **Bash Tool**
- 掃描資料夾尋找檔案
- 移動和重新命名檔案
- 建立資料夾結構
- 組織檔案

### 3. **Write Tool**
- 建立 CSV 摘要檔案
- 生成組織計畫文件
- 記錄變更日誌

### 4. **Python 文字處理庫**

可能使用的庫：
- **PyPDF2** 或 **pdfplumber**：PDF 文字提取
- **Pillow + Tesseract**：圖片 OCR
- **re**（正則表達式）：模式匹配
- **csv**：生成摘要試算表

---

## 最佳實踐

### 使用技巧

1. **電子郵件掃描成 PDF**：先將電子郵件發票保存為 PDF
2. **一致的下載位置**：將所有發票保存到一個資料夾以便批次處理
3. **每月例行作業**：每月整理發票，而非每年
4. **備份原始檔案**：重新組織前保留原始檔案
5. **在 CSV 中包含金額**：對預算追蹤有用
6. **標記可抵扣性**：註記哪些支出可抵稅
7. **保留收據 7 年**：標準稽核期限

### 檔案命名最佳實踐

**一致格式的價值**：
- 輕鬆排序和搜尋
- 一眼識別
- 專業外觀
- 會計師友善

### 自動化設定

**持續整理**：
```
建立監看我的 ~/Downloads/invoices 資料夾的腳本，使用我們的標準命名和資料夾結構自動整理任何新發票檔案。
```

這創建了一個持續的解決方案，在發票到達時就自動整理。

---

## 總結

### 成功要素

1. **自動化提取**：從 PDF 和圖片中智慧讀取資訊
2. **標準化命名**：一致的檔名格式
3. **靈活分類**：支援多種組織策略
4. **CSV 摘要**：會計師就緒的試算表
5. **安全性**：保留原始檔案

### 時間節省

**手動方式**：
- 開啟每張發票：147 × 1 分鐘 = 2.5 小時
- 提取資訊並記錄：147 × 2 分鐘 = 5 小時
- 重新命名：147 × 1 分鐘 = 2.5 小時
- 組織到資料夾：1 小時
- **總計：11 小時**

**使用此 Skill**：
- 自動處理：10-15 分鐘
- 審查和調整：15-20 分鐘
- **總計：25-35 分鐘**

**節省：~95% 時間**

### 適用場景

- 年度報稅準備
- 每月支出追蹤
- 季度財務審查
- 費用報銷文件
- 會計師溝通
- 稽核準備
- 企業記帳

### 靈感來源

此 skill 受到 Martin Merschroth 在 Lenny's Newsletter 中的使用案例啟發。

---

**最後更新**：2025-11-14
**文件版本**：1.0.0
**適用於**：Claude Code Skills
