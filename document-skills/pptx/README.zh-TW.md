# PPTX - PowerPoint ç°¡å ±è™•ç†æ­£é«”ä¸­æ–‡èªªæ˜æ–‡ä»¶

## ğŸ“‹ ç›®éŒ„
- [Skill æ¦‚è¿°](#skill-æ¦‚è¿°)
- [ç›®éŒ„çµæ§‹](#ç›®éŒ„çµæ§‹)
- [æª”æ¡ˆèªªæ˜](#æª”æ¡ˆèªªæ˜)
- [é—œéµè…³æœ¬åˆ†æ](#é—œéµè…³æœ¬åˆ†æ)
- [è¨­è¨ˆç­–ç•¥](#è¨­è¨ˆç­–ç•¥)
- [Claude Code ä½¿ç”¨æ–¹å¼](#claude-code-ä½¿ç”¨æ–¹å¼)
- [æŠ€è¡“æ¶æ§‹](#æŠ€è¡“æ¶æ§‹)
- [ä½¿ç”¨çš„ Prompt ç­–ç•¥](#ä½¿ç”¨çš„-prompt-ç­–ç•¥)
- [ä½¿ç”¨çš„å·¥å…·](#ä½¿ç”¨çš„å·¥å…·-tools)
- [æœ€ä½³å¯¦è¸](#æœ€ä½³å¯¦è¸)
- [ç¸½çµ](#ç¸½çµ)

---

## Skill æ¦‚è¿°

### é€™å€‹ Skill çš„åŠŸèƒ½
PPTX æ˜¯ä¸€å€‹å…¨æ–¹ä½çš„ Microsoft PowerPoint ç°¡å ±è™•ç†å·¥å…·å¥—ä»¶ï¼Œæä¾›ç°¡å ±çš„å»ºç«‹ã€ç·¨è¼¯ã€åˆ†æå’Œç¯„æœ¬é‡ç”¨åŠŸèƒ½ã€‚å®ƒä½¿ç”¨ Python å’Œ JavaScript åº«ä¾†æ“ä½œ Office Open XML (OOXML) æ ¼å¼ï¼Œä½¿ Claude èƒ½å¤ ï¼š
- å¾é›¶å»ºç«‹å…¨æ–°çš„ PowerPoint ç°¡å ±ï¼ˆä½¿ç”¨ html2pptxï¼‰
- ç·¨è¼¯ç¾æœ‰ç°¡å ±ä¸¦ä¿ç•™æ ¼å¼
- åŸºæ–¼ç¯„æœ¬å»ºç«‹æ–°ç°¡å ±ï¼ˆé‡æ’å’Œæ›¿æ›å…§å®¹ï¼‰
- æå–ç°¡å ±æ–‡å­—å…§å®¹å’Œçµæ§‹
- è¦–è¦ºåŒ–åˆ†æç°¡å ±ï¼ˆç¸®åœ–ç¶²æ ¼ï¼‰
- æª¢æ¸¬æ–‡å­—æº¢å‡ºå’Œå½¢ç‹€é‡ç–Šå•é¡Œ
- å»ºç«‹å°ˆæ¥­è¨­è¨ˆçš„ç°¡å ±ï¼ˆé¿å… AI é¢¨æ ¼ï¼‰

### è§£æ±ºçš„å•é¡Œ
åœ¨è™•ç† PowerPoint ç°¡å ±æ™‚ï¼Œç¶“å¸¸é‡åˆ°ä»¥ä¸‹æŒ‘æˆ°ï¼š

1. **è¨­è¨ˆä¸€è‡´æ€§å›°é›£**ï¼šAI ç”Ÿæˆçš„ç°¡å ±å¸¸æœ‰ã€ŒAI é¢¨æ ¼ã€ï¼ˆéåº¦ç½®ä¸­ã€ç´«è‰²æ¼¸å±¤ã€çµ±ä¸€åœ“è§’ï¼‰
2. **ç¯„æœ¬é‡ç”¨è¤‡é›œ**ï¼šéœ€è¦åŸºæ–¼ç¾æœ‰ç¯„æœ¬å»ºç«‹æ–°ç°¡å ±ï¼Œä½†æ‰‹å‹•è¤‡è£½è²¼ä¸Šæ•ˆç‡ä½
3. **å…§å®¹æº¢å‡ºå•é¡Œ**ï¼šæ–‡å­—è¶…å‡ºæ–‡å­—æ¡†é‚Šç•Œï¼Œåœ¨ç°¡å ±æ™‚æ‰ç™¼ç¾
4. **å½¢ç‹€é‡ç–Šæª¢æ¸¬**ï¼šæ‰‹å‹•æª¢æŸ¥æ•¸åå¼µæŠ•å½±ç‰‡çš„é‡ç–Šå•é¡Œè€—æ™‚
5. **æ‰¹æ¬¡è™•ç†éœ€æ±‚**ï¼šéœ€è¦ç”¢ç”Ÿå¤šä»½ç›¸ä¼¼ç°¡å ±ï¼ˆå¦‚æ¯æœˆå ±å‘Šï¼‰
6. **è¦–è¦ºé©—è­‰å›°é›£**ï¼šéœ€è¦å¿«é€Ÿé è¦½æ•´ä»½ç°¡å ±çš„ç‰ˆé¢é…ç½®

é€™å€‹ Skill é€éæä¾›å°ˆé–€çš„è…³æœ¬ã€è¦–è¦ºåˆ†æå·¥å…·å’Œå®Œæ•´çš„å·¥ä½œæµç¨‹è§£æ±ºäº†é€™äº›å•é¡Œï¼Œç‰¹åˆ¥æ˜¯é‡å°å°ˆæ¥­ç°¡å ±è£½ä½œçš„éœ€æ±‚ã€‚

---

## ç›®éŒ„çµæ§‹

```
pptx/
â”œâ”€â”€ SKILL.md                      # Skill ä¸»è¦èªªæ˜æ–‡ä»¶ï¼ˆè‹±æ–‡ï¼‰
â”œâ”€â”€ LICENSE.txt                   # æˆæ¬Šæ¢æ¬¾
â”œâ”€â”€ README.zh-TW.md              # æ­£é«”ä¸­æ–‡èªªæ˜æ–‡ä»¶ï¼ˆæœ¬æ–‡ä»¶ï¼‰
â”œâ”€â”€ html2pptx.md                 # html2pptx å·¥ä½œæµç¨‹æŒ‡å—
â”œâ”€â”€ ooxml.md                     # OOXML æ“ä½œè©³ç´°æ–‡æª”
â””â”€â”€ scripts/                      # Python/JavaScript è…³æœ¬ç›®éŒ„
    â”œâ”€â”€ thumbnail.py              # å»ºç«‹ç¸®åœ–ç¶²æ ¼
    â”œâ”€â”€ inventory.py              # æå–æ–‡å­—åº«å­˜å’Œæª¢æ¸¬å•é¡Œ
    â”œâ”€â”€ replace.py                # æ›¿æ›æ–‡å­—å…§å®¹
    â”œâ”€â”€ rearrange.py              # é‡æ–°æ’åˆ—æŠ•å½±ç‰‡
    â””â”€â”€ html2pptx.js              # HTML è½‰ PowerPoint
```

---

## æª”æ¡ˆèªªæ˜

### æ ¸å¿ƒæª”æ¡ˆ

#### 1. `SKILL.md`
- **ç”¨é€”**ï¼šSkill çš„ä¸»è¦èªªæ˜æ–‡ä»¶ï¼Œæä¾›å®Œæ•´çš„ä½¿ç”¨æŒ‡å—
- **å…§å®¹**ï¼š
  - ç°¡å ±è®€å–èˆ‡åˆ†ææ–¹æ³•
  - å»ºç«‹æ–°ç°¡å ±çš„å·¥ä½œæµç¨‹ï¼ˆç„¡ç¯„æœ¬ï¼‰
  - ç·¨è¼¯ç¾æœ‰ç°¡å ±çš„æ­¥é©Ÿ
  - åŸºæ–¼ç¯„æœ¬å»ºç«‹ç°¡å ±çš„è©³ç´°æµç¨‹
  - ç¸®åœ–ç¶²æ ¼å»ºç«‹æ–¹æ³•
  - è½‰æ›ç‚ºåœ–ç‰‡çš„æ–¹æ³•
- **ç‰¹é»**ï¼šæä¾›æ±ºç­–æ¨¹å’Œè©³ç´°çš„æ­¥é©Ÿèªªæ˜

#### 2. `html2pptx.md`
- **ç”¨é€”**ï¼šhtml2pptx å·¥ä½œæµç¨‹çš„è©³ç´°æŒ‡å—
- **å…§å®¹**ï¼š
  - HTML è½‰ PowerPoint çš„åŸç†
  - æ”¯æ´çš„ HTML æ¨™ç±¤å’Œæ¨£å¼
  - åœ–è¡¨å’Œè¡¨æ ¼çš„æ·»åŠ æ–¹æ³•
  - è¨­è¨ˆåŸå‰‡å’Œè‰²å½©é¸æ“‡
  - ç‰ˆé¢é…ç½®æœ€ä½³å¯¦è¸
- **é‡è¦æ€§**ï¼šå»ºç«‹ç„¡ç¯„æœ¬ç°¡å ±æ™‚çš„å¿…è®€æ–‡æª”

#### 3. `ooxml.md`
- **ç”¨é€”**ï¼šOOXML æ ¼å¼å’Œç›´æ¥ XML ç·¨è¼¯æŒ‡å—
- **å…§å®¹**ï¼š
  - OOXML çµæ§‹èªªæ˜
  - XML æª”æ¡ˆé—œä¿‚
  - é©—è­‰æ©Ÿåˆ¶
- **é©ç”¨**ï¼šéœ€è¦ç›´æ¥ç·¨è¼¯ XML çš„é€²éšå ´æ™¯

### Scripts ç›®éŒ„

#### 1. `thumbnail.py`ï¼ˆ451 è¡Œï¼‰
**åŠŸèƒ½**ï¼šå»ºç«‹ç°¡å ±çš„ç¸®åœ–ç¶²æ ¼ï¼Œç”¨æ–¼å¿«é€Ÿè¦–è¦ºé è¦½

**ä¸»è¦åŠŸèƒ½**ï¼š
- å°‡ PowerPoint è½‰æ›ç‚º PDFï¼Œå†è½‰ç‚ºåœ–ç‰‡
- å»ºç«‹ç¶²æ ¼ä½ˆå±€ï¼ˆ3-6 æ¬„å¯é¸ï¼‰
- æ”¯æ´éš±è—æŠ•å½±ç‰‡çš„è™•ç†ï¼ˆé¡¯ç¤ºç‚ºç°è‰²æ–œç·šï¼‰
- è‡ªå‹•åˆ†é ï¼ˆè¶…éå–®é å®¹é‡æ™‚å»ºç«‹å¤šå€‹ç¶²æ ¼ï¼‰
- å¯é¸ï¼šæ¨™ç¤ºæ–‡å­—å ä½ç¬¦ä½ç½®

**ä½¿ç”¨ç¯„ä¾‹**ï¼š
```bash
# åŸºæœ¬ç”¨æ³•ï¼ˆé è¨­ 5 æ¬„ï¼‰
python thumbnail.py presentation.pptx

# æŒ‡å®šè¼¸å‡ºåç¨±å’Œæ¬„æ•¸
python thumbnail.py template.pptx analysis --cols 4

# æ¨™ç¤ºå ä½ç¬¦ï¼ˆç”¨æ–¼ç¯„æœ¬åˆ†æï¼‰
python thumbnail.py template.pptx --outline-placeholders
```

**è¼¸å‡º**ï¼š
```
# å–®ä¸€ç¶²æ ¼
thumbnails.jpg

# å¤šå€‹ç¶²æ ¼ï¼ˆå¤§å‹ç°¡å ±ï¼‰
thumbnails-1.jpg
thumbnails-2.jpg
thumbnails-3.jpg
```

**ç¶²æ ¼å®¹é‡**ï¼š
- 3 æ¬„ï¼šæœ€å¤š 12 å¼µæŠ•å½±ç‰‡ï¼ˆ3Ã—4ï¼‰
- 4 æ¬„ï¼šæœ€å¤š 20 å¼µæŠ•å½±ç‰‡ï¼ˆ4Ã—5ï¼‰
- 5 æ¬„ï¼šæœ€å¤š 30 å¼µæŠ•å½±ç‰‡ï¼ˆ5Ã—6ï¼‰ã€é è¨­ã€‘
- 6 æ¬„ï¼šæœ€å¤š 42 å¼µæŠ•å½±ç‰‡ï¼ˆ6Ã—7ï¼‰

#### 2. `inventory.py`ï¼ˆ1,021 è¡Œï¼‰
**åŠŸèƒ½**ï¼šæå–ç°¡å ±çš„æ–‡å­—åº«å­˜ä¸¦æª¢æ¸¬ç‰ˆé¢å•é¡Œ

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
1. **æ–‡å­—æå–**ï¼š
   - æå–æ‰€æœ‰æ–‡å­—å½¢ç‹€çš„å…§å®¹
   - ä¿ç•™æ®µè½æ ¼å¼ï¼ˆå°é½Šã€é …ç›®ç¬¦è™Ÿã€å­—å‹ç­‰ï¼‰
   - è™•ç†ç¾¤çµ„å½¢ç‹€ï¼ˆGroupShapeï¼‰çš„çµ•å°ä½ç½®
   - æŒ‰è¦–è¦ºä½ç½®æ’åºå½¢ç‹€

2. **å•é¡Œæª¢æ¸¬**ï¼š
   - **æ–‡å­—æº¢å‡º**ï¼šæ–‡å­—è¶…å‡ºæ–‡å­—æ¡†åº•éƒ¨
   - **æŠ•å½±ç‰‡æº¢å‡º**ï¼šå½¢ç‹€è¶…å‡ºæŠ•å½±ç‰‡é‚Šç•Œ
   - **å½¢ç‹€é‡ç–Š**ï¼šå…©å€‹å½¢ç‹€é‡ç–Šè¶…éå®¹å¿å€¼
   - **æ ¼å¼è­¦å‘Š**ï¼šæ‰‹å‹•é …ç›®ç¬¦è™Ÿç¬¦è™Ÿï¼ˆâ€¢ï¼‰

3. **æ™ºæ…§éæ¿¾**ï¼š
   - è‡ªå‹•è·³éæŠ•å½±ç‰‡ç·¨è™Ÿ
   - éæ¿¾ç©ºç™½å½¢ç‹€
   - å¯é¸ï¼šåªé¡¯ç¤ºæœ‰å•é¡Œçš„å½¢ç‹€

**ä½¿ç”¨ç¯„ä¾‹**ï¼š
```bash
# æå–æ‰€æœ‰æ–‡å­—åº«å­˜
python inventory.py presentation.pptx inventory.json

# åªæå–æœ‰å•é¡Œçš„å½¢ç‹€
python inventory.py presentation.pptx issues.json --issues-only
```

**è¼¸å‡ºæ ¼å¼**ï¼ˆinventory.jsonï¼‰ï¼š
```json
{
  "slide-0": {
    "shape-0": {
      "left": 1.5,
      "top": 2.0,
      "width": 7.5,
      "height": 1.2,
      "placeholder_type": "TITLE",
      "default_font_size": 44.0,
      "paragraphs": [
        {
          "text": "æŠ•å½±ç‰‡æ¨™é¡Œ",
          "alignment": "CENTER",
          "bold": true,
          "font_size": 44.0
        }
      ],
      "overflow": {
        "frame": {"overflow_bottom": 0.15}
      }
    }
  }
}
```

#### 3. `replace.py`ï¼ˆ386 è¡Œï¼‰
**åŠŸèƒ½**ï¼šæ ¹æ“š JSON å®šç¾©æ›¿æ›ç°¡å ±ä¸­çš„æ–‡å­—å…§å®¹

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
1. **è‡ªå‹•æ¸…é™¤**ï¼šæ¸…é™¤æ‰€æœ‰åº«å­˜ä¸­çš„æ–‡å­—å½¢ç‹€
2. **é¸æ“‡æ€§æ›¿æ›**ï¼šåªæ›¿æ› JSON ä¸­å®šç¾©çš„å½¢ç‹€
3. **æ ¼å¼ä¿ç•™**ï¼šæ‡‰ç”¨æ®µè½å’Œå­—å‹å±¬æ€§
4. **é©—è­‰æ©Ÿåˆ¶**ï¼š
   - æª¢æŸ¥ JSON ä¸­çš„å½¢ç‹€æ˜¯å¦å­˜åœ¨
   - æª¢æ¸¬æ›¿æ›å¾Œçš„æ–‡å­—æº¢å‡º
   - æª¢æŸ¥æ‰‹å‹•é …ç›®ç¬¦è™Ÿ

**ä½¿ç”¨ç¯„ä¾‹**ï¼š
```bash
python replace.py input.pptx replacement.json output.pptx
```

**replacement.json æ ¼å¼**ï¼š
```json
{
  "slide-0": {
    "shape-0": {
      "paragraphs": [
        {
          "text": "æ–°æ¨™é¡Œ",
          "alignment": "CENTER",
          "bold": true,
          "font_size": 44.0
        }
      ]
    }
  }
}
```

**é©—è­‰è¼¸å‡º**ï¼š
```
ERROR: Replacement text made overflow worse in these shapes:
  - slide-0/shape-2: overflow worsened by 1.25" (was 0.00", now 1.25")

ERROR: Invalid shapes in replacement JSON:
  - Shape 'shape-99' not found on 'slide-0'. Available shapes: shape-0, shape-1, shape-4
```

#### 4. `rearrange.py`ï¼ˆ232 è¡Œï¼‰
**åŠŸèƒ½**ï¼šæ ¹æ“šç´¢å¼•åºåˆ—é‡æ–°æ’åˆ—æŠ•å½±ç‰‡

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
1. **è¤‡è£½é‡è¤‡æŠ•å½±ç‰‡**ï¼šè‡ªå‹•è™•ç†é‡è¤‡ä½¿ç”¨çš„æŠ•å½±ç‰‡
2. **åˆªé™¤æœªä½¿ç”¨æŠ•å½±ç‰‡**ï¼šç§»é™¤ä¸åœ¨åºåˆ—ä¸­çš„æŠ•å½±ç‰‡
3. **é‡æ–°æ’åº**ï¼šæŒ‰æŒ‡å®šé †åºæ’åˆ—æŠ•å½±ç‰‡
4. **ä¿ç•™é—œä¿‚**ï¼šç¶­è­·åœ–ç‰‡å’Œåª’é«”çš„é—œä¿‚

**ä½¿ç”¨ç¯„ä¾‹**ï¼š
```bash
# ä½¿ç”¨æŠ•å½±ç‰‡ 0, 34ï¼ˆå…©æ¬¡ï¼‰, 50, 52
python rearrange.py template.pptx output.pptx 0,34,34,50,52
```

**è™•ç†æµç¨‹**ï¼š
```
åŸå§‹ç¯„æœ¬ï¼š73 å¼µæŠ•å½±ç‰‡
åºåˆ—ï¼š0,34,34,50,52

æ­¥é©Ÿ 1ï¼šè¤‡è£½æŠ•å½±ç‰‡ 34ï¼ˆå»ºç«‹å‰¯æœ¬ï¼‰
æ­¥é©Ÿ 2ï¼šåˆªé™¤æœªä½¿ç”¨çš„ 68 å¼µæŠ•å½±ç‰‡
æ­¥é©Ÿ 3ï¼šé‡æ–°æ’åºç‚ºæŒ‡å®šé †åº
çµæœï¼š5 å¼µæŠ•å½±ç‰‡
```

#### 5. `html2pptx.js`
**åŠŸèƒ½**ï¼šå°‡ HTML æŠ•å½±ç‰‡è½‰æ›ç‚º PowerPoint

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- ä½¿ç”¨ Playwright æ¸²æŸ“ HTML
- æ“·å–ç‚ºé«˜è§£æåº¦åœ–ç‰‡
- å»ºç«‹ PowerPoint æŠ•å½±ç‰‡
- æ”¯æ´åœ–è¡¨å’Œè¡¨æ ¼çš„åŸç”Ÿæ·»åŠ 

**æ³¨æ„**ï¼šæ­¤æª”æ¡ˆæ˜¯ JavaScript æ¨¡çµ„ï¼Œéœ€è¦åœ¨å»ºç«‹ç°¡å ±çš„è…³æœ¬ä¸­å¼•ç”¨ã€‚

---

## é—œéµè…³æœ¬åˆ†æ

### thumbnail.py æ·±åº¦åˆ†æ

#### 1. éš±è—æŠ•å½±ç‰‡è™•ç†

**å•é¡Œ**ï¼šPowerPoint çš„éš±è—æŠ•å½±ç‰‡åœ¨è½‰ PDF æ™‚æœƒè¢«è·³é

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
```python
# æª¢æ¸¬éš±è—æŠ•å½±ç‰‡
hidden_slides = {
    idx + 1
    for idx, slide in enumerate(prs.slides)
    if slide.element.get("show") == "0"
}

# å»ºç«‹å ä½ç¬¦åœ–ç‰‡
if slide_num in hidden_slides:
    placeholder_img = create_hidden_slide_placeholder(size)
    # ç°è‰²èƒŒæ™¯ + æ–œç·šåœ–æ¡ˆ
```

**çµæœ**ï¼šç¸®åœ–ç¶²æ ¼ä¿ç•™æ‰€æœ‰æŠ•å½±ç‰‡çš„ä½ç½®ï¼Œéš±è—æŠ•å½±ç‰‡é¡¯ç¤ºç‚ºç°è‰²æ–œç·š

#### 2. è‡ªå‹•åˆ†é æ©Ÿåˆ¶

**è¨ˆç®—é‚è¼¯**ï¼š
```python
# æœ€å¤§æŠ•å½±ç‰‡æ•¸ = æ¬„æ•¸ Ã— (æ¬„æ•¸ + 1)
max_images_per_grid = cols * (cols + 1)

# ç¯„ä¾‹ï¼š5 æ¬„ â†’ 5 Ã— 6 = 30 å¼µ
# å¦‚æœæœ‰ 75 å¼µæŠ•å½±ç‰‡ï¼š
# ç¶²æ ¼ 1ï¼šæŠ•å½±ç‰‡ 0-29ï¼ˆ30 å¼µï¼‰
# ç¶²æ ¼ 2ï¼šæŠ•å½±ç‰‡ 30-59ï¼ˆ30 å¼µï¼‰
# ç¶²æ ¼ 3ï¼šæŠ•å½±ç‰‡ 60-74ï¼ˆ15 å¼µï¼‰
```

**æª”æ¡ˆå‘½å**ï¼š
```
# å–®ä¸€ç¶²æ ¼
thumbnails.jpg

# å¤šå€‹ç¶²æ ¼
thumbnails-1.jpg
thumbnails-2.jpg
thumbnails-3.jpg
```

#### 3. å ä½ç¬¦æ¨™ç¤ºåŠŸèƒ½

**ç”¨é€”**ï¼šåˆ†æç¯„æœ¬æ™‚è¦–è¦ºåŒ–æ–‡å­—å ä½ç¬¦ä½ç½®

**å¯¦ä½œ**ï¼š
```python
# ä½¿ç”¨ inventory.py æå–å ä½ç¬¦ä½ç½®
placeholder_regions = get_placeholder_regions(pptx_path)

# åœ¨ç¸®åœ–ä¸Šç¹ªè£½ç´…è‰²å¤–æ¡†
for region in placeholder_regions[slide_idx]:
    # è½‰æ›è‹±å¯¸åº§æ¨™ç‚ºåœ–ç‰‡åƒç´ 
    # ç¹ªè£½ç´…è‰²çŸ©å½¢å¤–æ¡†
```

**æ‡‰ç”¨**ï¼š
```bash
python thumbnail.py template.pptx analysis --outline-placeholders
# è®€å– analysis.jpgï¼Œçœ‹åˆ°æ‰€æœ‰æ–‡å­—æ¡†ä½ç½®
```

### inventory.py æ·±åº¦åˆ†æ

#### 1. ç¾¤çµ„å½¢ç‹€çš„çµ•å°ä½ç½®è¨ˆç®—

**å•é¡Œ**ï¼šPowerPoint ä¸­çš„ç¾¤çµ„å½¢ç‹€ï¼ˆGroupShapeï¼‰çš„å­å½¢ç‹€ä½ç½®æ˜¯ç›¸å°æ–¼ç¾¤çµ„çš„

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
```python
def collect_shapes_with_absolute_positions(
    shape, parent_left=0, parent_top=0
):
    """éè¿´è¨ˆç®—çµ•å°ä½ç½®"""
    if hasattr(shape, "shapes"):  # ç¾¤çµ„å½¢ç‹€
        # ç´¯ç©çˆ¶ç¾¤çµ„çš„åç§»
        abs_group_left = parent_left + shape.left
        abs_group_top = parent_top + shape.top

        # è™•ç†å­å½¢ç‹€
        for child in shape.shapes:
            result.extend(
                collect_shapes_with_absolute_positions(
                    child, abs_group_left, abs_group_top
                )
            )
```

**æ•ˆæœ**ï¼š
- æ­£ç¢ºè¨ˆç®—åµŒå¥—ç¾¤çµ„ä¸­å½¢ç‹€çš„ä½ç½®
- æ”¯æ´ä»»æ„æ·±åº¦çš„ç¾¤çµ„å·¢ç‹€
- ä½ç½®è³‡è¨Šç”¨æ–¼æ’åºå’Œé‡ç–Šæª¢æ¸¬

#### 2. æ–‡å­—æº¢å‡ºä¼°ç®—

**æŒ‘æˆ°**ï¼šæº–ç¢ºä¼°ç®—æ–‡å­—æ˜¯å¦æº¢å‡ºéœ€è¦è€ƒæ…®å¤šç¨®å› ç´ 

**å¯¦ä½œç­–ç•¥**ï¼š
```python
def _estimate_frame_overflow(self):
    """ä½¿ç”¨ PIL æ¸¬é‡æ–‡å­—é«˜åº¦"""

    # 1. è¨ˆç®—å¯ç”¨ç©ºé–“ï¼ˆæ‰£é™¤é‚Šè·ï¼‰
    usable_width_px, usable_height_px = self._get_usable_dimensions(text_frame)

    # 2. å°æ¯å€‹æ®µè½ï¼š
    for paragraph in text_frame.paragraphs:
        # a. è¼‰å…¥å­—å‹
        font = ImageFont.truetype(font_path, size=font_size)

        # b. æ–‡å­—æ›è¡Œ
        wrapped_lines = self._wrap_text_line(text, usable_width_px, draw, font)

        # c. è¨ˆç®—è¡Œé«˜
        if para_data.line_spacing:
            line_height_px = para_data.line_spacing * 96 / 72
        else:
            line_height_px = font_size * 96 / 72  # é è¨­å–®å€è¡Œè·

        # d. ç´¯ç©ç¸½é«˜åº¦
        total_height_px += len(wrapped_lines) * line_height_px
        total_height_px += space_before + space_after

    # 3. æª¢æŸ¥æº¢å‡ºï¼ˆè¶…é 0.05 è‹±å¯¸æ‰å ±å‘Šï¼‰
    if total_height_px > usable_height_px:
        overflow_inches = (total_height_px - usable_height_px) / 96.0
        if overflow_inches > 0.05:
            self.frame_overflow_bottom = overflow_inches
```

**è€ƒæ…®å› ç´ **ï¼š
- å­—å‹åç¨±å’Œå¤§å°
- è¡Œè·ï¼ˆline_spacingï¼‰
- æ®µè½é–“è·ï¼ˆspace_before, space_afterï¼‰
- æ–‡å­—æ¡†é‚Šè·
- æ–‡å­—æ›è¡Œ

#### 3. å½¢ç‹€é‡ç–Šæª¢æ¸¬

**æ¼”ç®—æ³•**ï¼š
```python
def calculate_overlap(rect1, rect2, tolerance=0.05):
    """è¨ˆç®—å…©çŸ©å½¢çš„é‡ç–Šé¢ç©"""
    left1, top1, w1, h1 = rect1
    left2, top2, w2, h2 = rect2

    # è¨ˆç®—é‡ç–Šå°ºå¯¸
    overlap_width = min(left1 + w1, left2 + w2) - max(left1, left2)
    overlap_height = min(top1 + h1, top2 + h2) - max(top1, top2)

    # æª¢æŸ¥æ˜¯å¦æœ‰æ„ç¾©çš„é‡ç–Šï¼ˆ> 0.05 è‹±å¯¸ï¼‰
    if overlap_width > tolerance and overlap_height > tolerance:
        overlap_area = overlap_width * overlap_height
        return True, round(overlap_area, 2)

    return False, 0
```

**è¼¸å‡ºæ ¼å¼**ï¼š
```json
{
  "overlap": {
    "overlapping_shapes": {
      "shape-2": 0.45,  // é‡ç–Šé¢ç©ï¼ˆå¹³æ–¹è‹±å¯¸ï¼‰
      "shape-5": 0.12
    }
  }
}
```

#### 4. è¦–è¦ºä½ç½®æ’åº

**ç­–ç•¥**ï¼š
```python
def sort_shapes_by_position(shapes):
    """ä¸Šåˆ°ä¸‹ã€å·¦åˆ°å³æ’åº"""

    # 1. æŒ‰ top ä½ç½®æ’åº
    shapes = sorted(shapes, key=lambda s: (s.top, s.left))

    # 2. åˆ†çµ„ç‚ºè¡Œï¼ˆå‚ç›´è·é›¢ < 0.5 è‹±å¯¸è¦–ç‚ºåŒä¸€è¡Œï¼‰
    rows = []
    current_row = [shapes[0]]
    row_top = shapes[0].top

    for shape in shapes[1:]:
        if abs(shape.top - row_top) <= 0.5:
            current_row.append(shape)
        else:
            # åŒä¸€è¡Œå…§æŒ‰ left æ’åº
            rows.extend(sorted(current_row, key=lambda s: s.left))
            current_row = [shape]
            row_top = shape.top

    # 3. æœ€å¾Œä¸€è¡Œ
    rows.extend(sorted(current_row, key=lambda s: s.left))
    return rows
```

**æ•ˆæœ**ï¼š
- `shape-0`, `shape-1`, ... æŒ‰é–±è®€é †åºç·¨è™Ÿ
- ç¬¦åˆäººé¡è¦–è¦ºç¿’æ…£
- ä¾¿æ–¼å…§å®¹æ›¿æ›

### replace.py æ·±åº¦åˆ†æ

#### 1. è‡ªå‹•æ¸…é™¤æ©Ÿåˆ¶

**ç­–ç•¥**ï¼š
```python
# æå–æ‰€æœ‰æ–‡å­—å½¢ç‹€çš„åº«å­˜
inventory = extract_text_inventory(pptx_file)

# æ¸…é™¤æ‰€æœ‰å½¢ç‹€
for shape_data in inventory:
    shape.text_frame.clear()

# åªæ›¿æ› JSON ä¸­å®šç¾©çš„å½¢ç‹€
if "paragraphs" in replacement_shape_data:
    # æ·»åŠ æ–°æ®µè½
```

**å„ªé»**ï¼š
- ç¢ºä¿æ²’æœ‰éºç•™èˆŠæ–‡å­—
- æ˜ç¢ºå®šç¾©å“ªäº›å½¢ç‹€æœ‰æ–°å…§å®¹
- é¿å…éƒ¨åˆ†æ›´æ–°å°è‡´çš„ä¸ä¸€è‡´

#### 2. é …ç›®ç¬¦è™Ÿè™•ç†

**å•é¡Œ**ï¼šPowerPoint çš„é …ç›®ç¬¦è™Ÿéœ€è¦ç‰¹æ®Šè™•ç†

**è§£æ±ºæ–¹æ¡ˆ**ï¼š
```python
def apply_paragraph_properties(paragraph, para_data):
    if para_data.get("bullet", False):
        # 1. è¨­å®šå±¤ç´š
        paragraph.level = para_data.get("level", 0)

        # 2. è¨ˆç®—ç¸®æ’ï¼ˆå­—å‹æ¯”ä¾‹ï¼‰
        font_size = para_data.get("font_size", 18.0)
        level_indent_emu = int((font_size * (1.6 + level * 1.6)) * 12700)
        hanging_indent_emu = int(-font_size * 0.8 * 12700)

        # 3. æ·»åŠ é …ç›®ç¬¦è™Ÿå­—å…ƒ
        buChar = OxmlElement("a:buChar")
        buChar.set("char", "â€¢")
        pPr.append(buChar)

        # 4. é è¨­å·¦å°é½Šï¼ˆé …ç›®ç¬¦è™Ÿä¸æ‡‰ç½®ä¸­ï¼‰
        if "alignment" not in para_data:
            paragraph.alignment = PP_ALIGN.LEFT
```

**æ³¨æ„**ï¼š
- ä¸è¦åœ¨æ–‡å­—ä¸­åŒ…å« `â€¢` ç¬¦è™Ÿï¼ˆæœƒè‡ªå‹•æ·»åŠ ï¼‰
- é …ç›®ç¬¦è™Ÿé è¨­å·¦å°é½Š
- ç¸®æ’é‡èˆ‡å­—é«”å¤§å°æˆæ¯”ä¾‹

#### 3. æº¢å‡ºé©—è­‰

**æµç¨‹**ï¼š
```python
# 1. è¨˜éŒ„åŸå§‹æº¢å‡ºç‹€æ³
original_overflow = detect_frame_overflow(inventory)

# 2. æ›¿æ›æ–‡å­—
# ...

# 3. æª¢æŸ¥æ›¿æ›å¾Œçš„æº¢å‡º
updated_overflow = detect_frame_overflow(updated_inventory)

# 4. æ¯”è¼ƒæº¢å‡ºæ˜¯å¦æƒ¡åŒ–
for slide_key, shape_overflows in updated_overflow.items():
    for shape_key, new_overflow in shape_overflows.items():
        original = original_overflow.get(slide_key, {}).get(shape_key, 0.0)

        if new_overflow > original + 0.01:
            # éŒ¯èª¤ï¼šæº¢å‡ºæƒ¡åŒ–
            raise ValueError(...)
```

**ç­–ç•¥**ï¼š
- å…è¨±åŸæœ¬å°±æº¢å‡ºçš„å½¢ç‹€ä¿æŒæº¢å‡º
- ç¦æ­¢ä½¿æº¢å‡ºè®Šå¾—æ›´åš´é‡
- ç¦æ­¢åŸæœ¬æ²’æº¢å‡ºçš„å½¢ç‹€è®Šæˆæº¢å‡º

### rearrange.py æ·±åº¦åˆ†æ

#### 1. æŠ•å½±ç‰‡è¤‡è£½é‚è¼¯

**æŒ‘æˆ°**ï¼šè¤‡è£½æŠ•å½±ç‰‡éœ€è¦è™•ç†åœ–ç‰‡å’Œåª’é«”é—œä¿‚

**å¯¦ä½œ**ï¼š
```python
def duplicate_slide(pres, index):
    """å®Œæ•´è¤‡è£½æŠ•å½±ç‰‡ï¼ŒåŒ…æ‹¬åœ–ç‰‡é—œä¿‚"""
    source = pres.slides[index]
    new_slide = pres.slides.add_slide(source.slide_layout)

    # 1. æ”¶é›†æ‰€æœ‰åœ–ç‰‡é—œä¿‚
    image_rels = {}
    for rel_id, rel in source.part.rels.items():
        if "image" in rel.reltype or "media" in rel.reltype:
            image_rels[rel_id] = rel

    # 2. æ¸…é™¤å ä½ç¬¦ï¼ˆé¿å…é‡è¤‡ï¼‰
    for shape in new_slide.shapes:
        shape.element.getparent().remove(shape.element)

    # 3. è¤‡è£½æ‰€æœ‰å½¢ç‹€
    for shape in source.shapes:
        new_el = deepcopy(shape.element)
        new_slide.shapes._spTree.insert_element_before(new_el, "p:extLst")

        # 4. æ›´æ–°åœ–ç‰‡åƒè€ƒ
        blips = new_el.xpath(".//a:blip[@r:embed]")
        for blip in blips:
            old_rId = blip.get("{...}embed")
            if old_rId in image_rels:
                # å»ºç«‹æ–°é—œä¿‚
                new_rId = new_slide.part.rels.get_or_add(...)
                blip.set("{...}embed", new_rId)
```

**ç¢ºä¿**ï¼š
- å®Œæ•´è¤‡è£½å½¢ç‹€å’Œå±¬æ€§
- æ­£ç¢ºè™•ç†åœ–ç‰‡åƒè€ƒ
- é¿å…å ä½ç¬¦é‡è¤‡

#### 2. ä¸‰æ­¥é©Ÿè™•ç†

**ç‚ºä»€éº¼éœ€è¦ä¸‰å€‹æ­¥é©Ÿ**ï¼š
```python
# æ­¥é©Ÿ 1ï¼šè¤‡è£½é‡è¤‡æŠ•å½±ç‰‡
# ç¯„ä¾‹ï¼šåºåˆ— [0, 34, 34, 50, 52]
#       æŠ•å½±ç‰‡ 34 å‡ºç¾å…©æ¬¡ï¼Œå»ºç«‹ä¸€å€‹å‰¯æœ¬

# æ­¥é©Ÿ 2ï¼šåˆªé™¤æœªä½¿ç”¨æŠ•å½±ç‰‡ï¼ˆå¾å¾Œå¾€å‰ï¼‰
# ä¿ç•™çš„æŠ•å½±ç‰‡ï¼š0, 34, 34çš„å‰¯æœ¬, 50, 52
# åˆªé™¤å…¶ä»– 68 å¼µ

# æ­¥é©Ÿ 3ï¼šé‡æ–°æ’åº
# å°‡ä¿ç•™çš„æŠ•å½±ç‰‡æ’åˆ—ç‚ºæŒ‡å®šé †åº
```

**å„ªé»**ï¼š
- æ¸…æ™°çš„ä¸‰éšæ®µè™•ç†
- é¿å…ç´¢å¼•éŒ¯èª¤ï¼ˆå¾å¾Œå¾€å‰åˆªé™¤ï¼‰
- å¯é™¤éŒ¯ï¼ˆæ¯æ­¥é©Ÿéƒ½æœ‰è¼¸å‡ºï¼‰

---

## è¨­è¨ˆç­–ç•¥

### 1. ä¸‰ç¨®ç°¡å ±å»ºç«‹è·¯å¾‘

**è·¯å¾‘ Aï¼šç„¡ç¯„æœ¬å»ºç«‹**
```
éœ€æ±‚ï¼šå¾é›¶å»ºç«‹ç°¡å ±
å·¥å…·ï¼šhtml2pptx
æµç¨‹ï¼š
1. åˆ†æå…§å®¹å’Œé¸æ“‡è¨­è¨ˆ
2. å»ºç«‹ HTML æŠ•å½±ç‰‡
3. ä½¿ç”¨ html2pptx.js è½‰æ›
4. è¦–è¦ºé©—è­‰
```

**è·¯å¾‘ Bï¼šç¯„æœ¬é‡ç”¨**
```
éœ€æ±‚ï¼šåŸºæ–¼ç¾æœ‰ç¯„æœ¬å»ºç«‹æ–°ç°¡å ±
å·¥å…·ï¼šthumbnail + inventory + rearrange + replace
æµç¨‹ï¼š
1. åˆ†æç¯„æœ¬ï¼ˆç¸®åœ– + åº«å­˜ï¼‰
2. é¸æ“‡å’Œé‡æ’æŠ•å½±ç‰‡
3. æ›¿æ›æ–‡å­—å…§å®¹
4. é©—è­‰æº¢å‡ºå’Œé‡ç–Š
```

**è·¯å¾‘ Cï¼šç›´æ¥ç·¨è¼¯**
```
éœ€æ±‚ï¼šå°å¹…ä¿®æ”¹ç¾æœ‰ç°¡å ±
å·¥å…·ï¼šOOXML ç·¨è¼¯
æµç¨‹ï¼š
1. è§£å£“ .pptx
2. ç·¨è¼¯ XML
3. é©—è­‰
4. é‡æ–°æ‰“åŒ…
```

### 2. è¦–è¦ºé©—è­‰å„ªå…ˆ

**é©—è­‰é»**ï¼š
1. **ç¯„æœ¬åˆ†æ**ï¼šç¸®åœ–ç¶²æ ¼å¿«é€Ÿé è¦½
2. **å ä½ç¬¦æª¢æŸ¥**ï¼šä½¿ç”¨ --outline-placeholders
3. **å…§å®¹é©—è­‰**ï¼šæª¢æŸ¥æº¢å‡ºå’Œé‡ç–Š
4. **æœ€çµ‚ç¢ºèª**ï¼šå†æ¬¡å»ºç«‹ç¸®åœ–

**å·¥å…·éˆ**ï¼š
```bash
# åˆ†æ
python thumbnail.py template.pptx analysis --cols 4 --outline-placeholders

# æª¢æ¸¬å•é¡Œ
python inventory.py output.pptx issues.json --issues-only

# é©—è­‰çµæœ
python thumbnail.py output.pptx final
```

### 3. é˜²æ­¢ AI é¢¨æ ¼

**SKILL.md æ˜ç¢ºåˆ—å‡ºè¦é¿å…çš„ç‰¹å¾µ**ï¼š
- âŒ éåº¦ç½®ä¸­çš„ç‰ˆé¢
- âŒ ç´«è‰²æ¼¸å±¤
- âŒ çµ±ä¸€çš„åœ“è§’
- âŒ Inter å­—å‹ï¼ˆéåº¦ä½¿ç”¨ï¼‰

**è¨­è¨ˆåŸå‰‡**ï¼š
- âœ… æ ¹æ“šå…§å®¹é¸æ“‡è‰²å½©
- âœ… è€ƒæ…®å“ç‰Œè­˜åˆ¥
- âœ… ä½¿ç”¨å¤šæ¨£åŒ–çš„ç‰ˆé¢é…ç½®
- âœ… å»ºç«‹æ¸…æ™°çš„è¦–è¦ºå±¤æ¬¡

### 4. æ‰¹æ¬¡è™•ç†æ”¯æ´

**ç¯„æœ¬æ˜ å°„**ï¼š
```python
template_mapping = [
    0,   # æ¨™é¡ŒæŠ•å½±ç‰‡
    34,  # å…§å®¹ä½ˆå±€
    34,  # å†æ¬¡ä½¿ç”¨ç›¸åŒä½ˆå±€
    50,  # å¼•ç”¨ä½ˆå±€
    52,  # çµå°¾æŠ•å½±ç‰‡
]
```

**è‡ªå‹•åŒ–æµç¨‹**ï¼š
```bash
# 1. å»ºç«‹æ˜ å°„
# 2. é‡æ’æŠ•å½±ç‰‡
python rearrange.py template.pptx working.pptx 0,34,34,50,52

# 3. æå–åº«å­˜
python inventory.py working.pptx inventory.json

# 4. æº–å‚™æ›¿æ›å…§å®¹
# 5. æ›¿æ›
python replace.py working.pptx replacement.json output.pptx
```

---

## Claude Code ä½¿ç”¨æ–¹å¼

### è§¸ç™¼æ™‚æ©Ÿ

Claude Code æœƒåœ¨ä»¥ä¸‹æƒ…æ³ä½¿ç”¨æ­¤ Skillï¼š

1. **å»ºç«‹å…¨æ–°ç°¡å ±**
   - ç¯„ä¾‹ï¼šã€Œå»ºç«‹ä¸€ä»½ç”¢å“ç™¼è¡¨ç°¡å ±ã€
   - ç¯„ä¾‹ï¼šã€Œè£½ä½œå­£åº¦å ±å‘Šç°¡å ±ã€

2. **åŸºæ–¼ç¯„æœ¬å»ºç«‹ç°¡å ±**
   - ç¯„ä¾‹ï¼šã€Œä½¿ç”¨é€™å€‹ç¯„æœ¬å»ºç«‹æ–°çš„æœˆå ±ã€
   - ç¯„ä¾‹ï¼šã€Œå¥—ç”¨å…¬å¸ç¯„æœ¬è£½ä½œææ¡ˆã€

3. **ç·¨è¼¯ç¾æœ‰ç°¡å ±**
   - ç¯„ä¾‹ï¼šã€Œæ›´æ–°ç°¡å ±ä¸­çš„æ•¸å­—ã€
   - ç¯„ä¾‹ï¼šã€Œä¿®æ”¹æŠ•å½±ç‰‡æ¨™é¡Œã€

4. **åˆ†æç°¡å ±çµæ§‹**
   - ç¯„ä¾‹ï¼šã€Œåˆ†æé€™ä»½ç°¡å ±çš„ç‰ˆé¢é…ç½®ã€
   - ç¯„ä¾‹ï¼šã€Œæª¢æŸ¥ç°¡å ±æ˜¯å¦æœ‰æ–‡å­—æº¢å‡ºã€

5. **æ‰¹æ¬¡ç”¢ç”Ÿç°¡å ±**
   - ç¯„ä¾‹ï¼šã€Œç‚ºæ¯å€‹åˆ†å…¬å¸å»ºç«‹ç›¸åŒæ ¼å¼çš„å ±å‘Šã€

### å…¸å‹å·¥ä½œæµç¨‹

#### å·¥ä½œæµç¨‹ 1ï¼šå»ºç«‹ç„¡ç¯„æœ¬ç°¡å ±

```bash
# æ­¥é©Ÿ 1ï¼šè®€å– html2pptx.mdï¼ˆå®Œæ•´æª”æ¡ˆï¼‰
# Claude äº†è§£è¨­è¨ˆåŸå‰‡å’Œ HTML èªæ³•

# æ­¥é©Ÿ 2ï¼šåˆ†æå…§å®¹ä¸¦é¸æ“‡è¨­è¨ˆ
# - æ ¹æ“šä¸»é¡Œé¸æ“‡è‰²å½©æ–¹æ¡ˆ
# - æ±ºå®šç‰ˆé¢é…ç½®ç­–ç•¥

# æ­¥é©Ÿ 3ï¼šå»ºç«‹ HTML æŠ•å½±ç‰‡æª”æ¡ˆ
# slide-1.html, slide-2.html, ...

# æ­¥é©Ÿ 4ï¼šå»ºç«‹è½‰æ›è…³æœ¬
# create-presentation.js

# æ­¥é©Ÿ 5ï¼šåŸ·è¡Œè½‰æ›
node create-presentation.js

# æ­¥é©Ÿ 6ï¼šå»ºç«‹ç¸®åœ–é©—è­‰
python thumbnail.py output.pptx
# è®€å– thumbnails.jpgï¼Œè¦–è¦ºæª¢æŸ¥ç‰ˆé¢
```

#### å·¥ä½œæµç¨‹ 2ï¼šåŸºæ–¼ç¯„æœ¬å»ºç«‹ç°¡å ±

```bash
# æ­¥é©Ÿ 1ï¼šåˆ†æç¯„æœ¬
## a. æå–æ–‡å­—ä¸¦å»ºç«‹ç¸®åœ–
python -m markitdown template.pptx > template-content.md
python thumbnail.py template.pptx --outline-placeholders

## b. è®€å–ä¸¦å»ºç«‹åº«å­˜æª”æ¡ˆ
# Claude è®€å– template-content.md å’Œ thumbnails.jpg
# å»ºç«‹ template-inventory.mdï¼Œè¨˜éŒ„æ¯å¼µæŠ•å½±ç‰‡çš„ç”¨é€”

# æ­¥é©Ÿ 2ï¼šå»ºç«‹ç°¡å ±å¤§ç¶±
# Claude å»ºç«‹ outline.mdï¼Œé¸æ“‡è¦ä½¿ç”¨çš„ç¯„æœ¬æŠ•å½±ç‰‡

# æ­¥é©Ÿ 3ï¼šé‡æ’æŠ•å½±ç‰‡
python rearrange.py template.pptx working.pptx 0,34,34,50,52

# æ­¥é©Ÿ 4ï¼šæå–æ–‡å­—åº«å­˜
python inventory.py working.pptx text-inventory.json
# Claude è®€å– text-inventory.json

# æ­¥é©Ÿ 5ï¼šæº–å‚™æ›¿æ›å…§å®¹
# Claude å»ºç«‹ replacement-text.json

# æ­¥é©Ÿ 6ï¼šæ›¿æ›æ–‡å­—
python replace.py working.pptx replacement-text.json output.pptx

# æ­¥é©Ÿ 7ï¼šé©—è­‰
## a. æª¢æŸ¥å•é¡Œ
python inventory.py output.pptx issues.json --issues-only

## b. å»ºç«‹æœ€çµ‚ç¸®åœ–
python thumbnail.py output.pptx final
```

#### å·¥ä½œæµç¨‹ 3ï¼šæª¢æ¸¬ç°¡å ±å•é¡Œ

```bash
# æ­¥é©Ÿ 1ï¼šæå–æœ‰å•é¡Œçš„å½¢ç‹€
python inventory.py presentation.pptx issues.json --issues-only

# æ­¥é©Ÿ 2ï¼šClaude è®€å– issues.json
# åˆ†æå•é¡Œï¼š
# - frame_overflow_bottom: æ–‡å­—æº¢å‡º
# - overlap: å½¢ç‹€é‡ç–Š
# - warnings: æ ¼å¼å•é¡Œ

# æ­¥é©Ÿ 3ï¼šå»ºè­°ä¿®æ­£æ–¹æ¡ˆ
```

### ä¸ä½¿ç”¨æ­¤ Skill çš„æƒ…æ³
- Word æ–‡ä»¶ï¼ˆä½¿ç”¨ docx skillï¼‰
- PDF æ–‡ä»¶ï¼ˆä½¿ç”¨ pdf skillï¼‰
- Excel è©¦ç®—è¡¨ï¼ˆä½¿ç”¨ xlsx skillï¼‰

---

## æŠ€è¡“æ¶æ§‹

### æŠ€è¡“å †ç–Š

**Python ç”Ÿæ…‹ç³»**ï¼š
```
python-pptx     # PowerPoint æ“ä½œï¼ˆè®€å¯«ã€å½¢ç‹€ã€æ–‡å­—ï¼‰
Pillow (PIL)    # åœ–ç‰‡è™•ç†ï¼ˆç¸®åœ–ã€é©—è­‰åœ–ç‰‡ï¼‰
markitdown      # PPTX è½‰ Markdown
defusedxml      # å®‰å…¨çš„ XML è§£æ
```

**JavaScript/Node.js ç”Ÿæ…‹ç³»**ï¼š
```
pptxgenjs       # PowerPoint ç”Ÿæˆ
playwright      # HTML æ¸²æŸ“
sharp           # SVG å…‰æŸµåŒ–å’Œåœ–ç‰‡è™•ç†
react-icons     # åœ–ç¤ºåº«
```

**å‘½ä»¤åˆ—å·¥å…·**ï¼š
```
soffice         # LibreOfficeï¼ˆPPTX â†’ PDFï¼‰
pdftoppm        # Popplerï¼ˆPDF â†’ åœ–ç‰‡ï¼‰
```

### ä¾è³´é—œä¿‚åœ–

```
ç°¡å ±å»ºç«‹å·¥ä½œæµç¨‹
â”œâ”€â”€ ç„¡ç¯„æœ¬è·¯å¾‘
â”‚   â”œâ”€â”€ HTML æŠ•å½±ç‰‡å»ºç«‹
â”‚   â”œâ”€â”€ html2pptx.js
â”‚   â”‚   â”œâ”€â”€ playwrightï¼ˆæ¸²æŸ“ï¼‰
â”‚   â”‚   â”œâ”€â”€ sharpï¼ˆåœ–ç‰‡è™•ç†ï¼‰
â”‚   â”‚   â””â”€â”€ pptxgenjsï¼ˆPowerPoint ç”Ÿæˆï¼‰
â”‚   â””â”€â”€ thumbnail.pyï¼ˆé©—è­‰ï¼‰
â”œâ”€â”€ ç¯„æœ¬é‡ç”¨è·¯å¾‘
â”‚   â”œâ”€â”€ thumbnail.py
â”‚   â”‚   â”œâ”€â”€ sofficeï¼ˆPPTX â†’ PDFï¼‰
â”‚   â”‚   â””â”€â”€ pdftoppmï¼ˆPDF â†’ åœ–ç‰‡ï¼‰
â”‚   â”œâ”€â”€ inventory.py
â”‚   â”‚   â”œâ”€â”€ python-pptxï¼ˆè®€å–ï¼‰
â”‚   â”‚   â””â”€â”€ PILï¼ˆæ–‡å­—æ¸¬é‡ï¼‰
â”‚   â”œâ”€â”€ rearrange.py
â”‚   â”‚   â””â”€â”€ python-pptxï¼ˆæŠ•å½±ç‰‡æ“ä½œï¼‰
â”‚   â””â”€â”€ replace.py
â”‚       â””â”€â”€ python-pptxï¼ˆæ–‡å­—æ›¿æ›ï¼‰
â””â”€â”€ ç›´æ¥ç·¨è¼¯è·¯å¾‘
    â””â”€â”€ OOXML æ“ä½œ
        â””â”€â”€ defusedxml
```

### OOXML ç°¡å ±çµæ§‹

```
presentation.pptxï¼ˆZIP æª”æ¡ˆï¼‰
â”œâ”€â”€ [Content_Types].xml
â”œâ”€â”€ _rels/
â”‚   â””â”€â”€ .rels
â”œâ”€â”€ ppt/
â”‚   â”œâ”€â”€ presentation.xml          # ç°¡å ±å…ƒè³‡æ–™
â”‚   â”œâ”€â”€ slides/
â”‚   â”‚   â”œâ”€â”€ slide1.xml            # æŠ•å½±ç‰‡å…§å®¹
â”‚   â”‚   â”œâ”€â”€ slide2.xml
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ slideLayouts/             # ç‰ˆé¢é…ç½®ç¯„æœ¬
â”‚   â”œâ”€â”€ slideMasters/             # æ¯ç‰‡ç¯„æœ¬
â”‚   â”œâ”€â”€ theme/
â”‚   â”‚   â””â”€â”€ theme1.xml            # ä¸»é¡Œï¼ˆè‰²å½©ã€å­—å‹ï¼‰
â”‚   â”œâ”€â”€ media/                    # åœ–ç‰‡å’Œåª’é«”
â”‚   â””â”€â”€ _rels/
â”‚       â””â”€â”€ slide1.xml.rels       # æŠ•å½±ç‰‡é—œä¿‚
â””â”€â”€ docProps/
    â”œâ”€â”€ core.xml                  # æ ¸å¿ƒå±¬æ€§
    â””â”€â”€ app.xml                   # æ‡‰ç”¨ç¨‹å¼å±¬æ€§
```

---

## ä½¿ç”¨çš„ Prompt ç­–ç•¥

### 1. è¨­è¨ˆå…§å®¹æ„ŸçŸ¥

**å¼·åˆ¶è¨­è¨ˆæ€è€ƒ**ï¼š
```markdown
**CRITICAL**: Before creating any presentation, analyze the content and choose appropriate design elements:
1. **Consider the subject matter**: What is this presentation about?
2. **Check for branding**: If the user mentions a company/organization
3. **Match palette to content**: Select colors that reflect the subject
4. **State your approach**: Explain your design choices BEFORE writing code
```

**ç¯„ä¾‹è‰²å½©æ–¹æ¡ˆ**ï¼š
- æä¾› 18 ç¨®é è¨­è‰²å½©æ–¹æ¡ˆï¼ˆç¶“å…¸è—ã€çŠç‘šè‰²ã€å‹ƒè‰®ç¬¬å¥¢è¯ç­‰ï¼‰
- é¼“å‹µå‰µé€ æ€§é¸æ“‡ï¼Œé¿å…è‡ªå‹•é§•é§›

### 2. ç‰ˆé¢é…ç½®æŒ‡å¼•

**å…§å®¹çµæ§‹åŒ¹é…**ï¼š
```markdown
**CRITICAL: Match layout structure to actual content**:
- Single-column layouts: Use for unified narrative
- Two-column layouts: Use ONLY when you have exactly 2 distinct items
- Three-column layouts: Use ONLY when you have exactly 3 distinct items
- Count your actual content pieces BEFORE selecting the layout
```

**åœ–è¡¨/è¡¨æ ¼ç‰ˆé¢**ï¼š
```markdown
**When creating slides with charts or tables:**
- **Two-column layout (PREFERRED)**: Header spanning full width, then text in one column and chart in the other
- **Full-slide layout**: Let the chart take up the entire slide
- **NEVER vertically stack**: Don't place charts below text
```

### 3. ç¯„æœ¬åˆ†ææµç¨‹

**åº«å­˜æª”æ¡ˆæ ¼å¼**ï¼š
```markdown
# Template Inventory Analysis
**Total Slides: [count]**
**IMPORTANT: Slides are 0-indexed (first slide = 0, last slide = count-1)**

## [Category Name]
- Slide 0: [Layout code] - Description/purpose
- Slide 1: [Layout code] - Description/purpose
[... EVERY slide must be listed individually ...]
```

### 4. é©—è­‰å¼·èª¿

**å¤šè™•å¼·èª¿é©—è­‰**ï¼š
```markdown
**Visual validation**: Generate thumbnails and inspect for layout issues
**IMPORTANT**: Check the thumbnail image for text cutoff, overlap, positioning issues
If issues found, adjust HTML margins/spacing/colors and regenerate
```

---

## ä½¿ç”¨çš„å·¥å…·ï¼ˆToolsï¼‰

æ­¤ Skill ä¸»è¦ä¾è³´ä»¥ä¸‹ Claude Code å·¥å…·ï¼š

### 1. **Read Tool**
- è®€å– SKILL.mdã€html2pptx.mdã€ooxml.md
- è®€å–ç¸®åœ–ç¶²æ ¼åœ–ç‰‡ï¼ˆè¦–è¦ºåˆ†æï¼‰
- è®€å– inventory.jsonï¼ˆäº†è§£å½¢ç‹€çµæ§‹ï¼‰
- è®€å–é©—è­‰åœ–ç‰‡ï¼ˆå ä½ç¬¦æ¨™ç¤ºï¼‰

### 2. **Write Tool**
- å»ºç«‹ HTML æŠ•å½±ç‰‡æª”æ¡ˆ
- å»ºç«‹ JavaScript è½‰æ›è…³æœ¬
- å»ºç«‹ replacement-text.json
- å»ºç«‹ç¯„æœ¬åº«å­˜æª”æ¡ˆ

### 3. **Bash Tool**
- åŸ·è¡Œ thumbnail.pyï¼ˆå»ºç«‹ç¸®åœ–ï¼‰
- åŸ·è¡Œ inventory.pyï¼ˆæå–åº«å­˜ï¼‰
- åŸ·è¡Œ rearrange.pyï¼ˆé‡æ’æŠ•å½±ç‰‡ï¼‰
- åŸ·è¡Œ replace.pyï¼ˆæ›¿æ›æ–‡å­—ï¼‰
- åŸ·è¡Œ Node.js è…³æœ¬ï¼ˆhtml2pptxï¼‰
- åŸ·è¡Œ soffice å’Œ pdftoppm

### 4. **Edit Tool**
- ä¿®æ­£ replacement-text.json
- èª¿æ•´ HTML æŠ•å½±ç‰‡
- ä¿®æ”¹è…³æœ¬åƒæ•¸

---

## æœ€ä½³å¯¦è¸

### 1. è¨­è¨ˆé¸æ“‡

**âœ… å»ºè­°åšæ³•**ï¼š
```
1. åˆ†æå…§å®¹ä¸»é¡Œ
2. è€ƒæ…®å“ç‰Œè­˜åˆ¥ï¼ˆå¦‚æåŠå…¬å¸ï¼‰
3. é¸æ“‡ç¬¦åˆä¸»é¡Œçš„è‰²å½©
4. è§£é‡‹è¨­è¨ˆé¸æ“‡
5. å»ºç«‹å¤šæ¨£åŒ–çš„ç‰ˆé¢é…ç½®
```

**âŒ é¿å…åšæ³•**ï¼š
```
è‡ªå‹•ä½¿ç”¨ç´«è‰²æ¼¸å±¤
æ‰€æœ‰æŠ•å½±ç‰‡ç½®ä¸­å°é½Š
çµ±ä¸€ä½¿ç”¨åœ“è§’
ä¸è€ƒæ…®å…§å®¹å°±é¸æ“‡é¡è‰²
```

### 2. ç¯„æœ¬é‡ç”¨

**æŠ•å½±ç‰‡é¸æ“‡**ï¼š
```
âœ… é¸æ“‡æ–‡å­—å‹ç‰ˆé¢é…ç½®
âœ… ç¢ºèªç‰ˆé¢é…ç½®èˆ‡å…§å®¹æ•¸é‡åŒ¹é…
âœ… é©—è­‰ç´¢å¼•åœ¨ç¯„åœå…§ï¼ˆ0-basedï¼‰
âœ… å»ºç«‹åº«å­˜æª”æ¡ˆä¾›åƒè€ƒ
```

**é¿å…**ï¼š
```
âŒ ä½¿ç”¨æ¯”å…§å®¹å¤šçš„æ¬„ä½ç‰ˆé¢
âŒ å¼·åˆ¶å…§å®¹é©æ‡‰éŒ¯èª¤çš„ç‰ˆé¢
âŒ ä½¿ç”¨è¶…å‡ºç¯„åœçš„ç´¢å¼•
âŒ è·³éç¯„æœ¬åˆ†ææ­¥é©Ÿ
```

### 3. æ–‡å­—æ›¿æ›

**replacement.json å»ºç«‹**ï¼š
```json
{
  "slide-0": {
    "shape-0": {
      "paragraphs": [
        {
          "text": "æ¨™é¡Œæ–‡å­—",
          "alignment": "CENTER",
          "bold": true,
          "font_size": 44.0
        }
      ]
    },
    "shape-1": {
      "paragraphs": [
        {
          "text": "ç¬¬ä¸€å€‹è¦é»",
          "bullet": true,
          "level": 0
        },
        {
          "text": "ç¬¬äºŒå€‹è¦é»",
          "bullet": true,
          "level": 0
        }
      ]
    }
  }
}
```

**æ³¨æ„äº‹é …**ï¼š
- âœ… åŒ…å«åŸå§‹æ ¼å¼å±¬æ€§ï¼ˆboldã€alignment ç­‰ï¼‰
- âœ… é …ç›®ç¬¦è™Ÿæ–‡å­—ä¸åŒ…å« `â€¢` ç¬¦è™Ÿ
- âœ… é …ç›®ç¬¦è™Ÿæ™‚ä¸è¨­å®š alignmentï¼ˆé è¨­å·¦å°é½Šï¼‰
- âœ… æª¢æŸ¥ default_font_size é¸æ“‡åˆé©å­—é«”å¤§å°
- âŒ ä¸è¦åªæä¾›ç´”æ–‡å­—å­—ä¸²

### 4. é©—è­‰æµç¨‹

**å®Œæ•´é©—è­‰**ï¼š
```bash
# 1. å»ºç«‹ç¸®åœ–ï¼ˆå¿«é€Ÿè¦–è¦ºæª¢æŸ¥ï¼‰
python thumbnail.py output.pptx

# 2. æª¢æ¸¬å•é¡Œï¼ˆè©³ç´°åˆ†æï¼‰
python inventory.py output.pptx issues.json --issues-only

# 3. è®€å–å•é¡Œå ±å‘Š
# å¦‚æœæœ‰æº¢å‡ºæˆ–é‡ç–Šï¼Œä¿®æ­£å¾Œé‡æ–°åŸ·è¡Œ
```

**å•é¡Œé¡å‹**ï¼š
```json
{
  "overflow": {
    "frame": {"overflow_bottom": 0.25}  // æ–‡å­—è¶…å‡º 0.25 è‹±å¯¸
  },
  "overlap": {
    "overlapping_shapes": {
      "shape-3": 0.45  // èˆ‡ shape-3 é‡ç–Š 0.45 å¹³æ–¹è‹±å¯¸
    }
  },
  "warnings": [
    "manual_bullet_symbol: use proper bullet formatting"
  ]
}
```

### 5. æ‰¹æ¬¡è™•ç†

**æ¨¡æ¿åŒ–æ–¹æ³•**ï¼š
```python
# å®šç¾©å¯é‡ç”¨çš„æ˜ å°„
MONTHLY_REPORT_TEMPLATE = [0, 34, 34, 50, 52]

# å»ºç«‹å¤šä»½å ±å‘Š
for month in ["Jan", "Feb", "Mar"]:
    # 1. é‡æ’æŠ•å½±ç‰‡
    rearrange(template, f"{month}-working.pptx", MONTHLY_REPORT_TEMPLATE)

    # 2. æº–å‚™è©²æœˆä»½çš„è³‡æ–™
    data = load_monthly_data(month)

    # 3. å»ºç«‹æ›¿æ› JSON
    replacement = create_replacement_json(data)

    # 4. æ›¿æ›
    replace(f"{month}-working.pptx", replacement, f"{month}-report.pptx")
```

---

## ç¸½çµ

### æˆåŠŸè¦ç´ 

1. **è¦–è¦ºé©—è­‰æ©Ÿåˆ¶**ï¼šç¸®åœ–ç¶²æ ¼æä¾›å¿«é€Ÿé è¦½å’Œå•é¡Œæª¢æ¸¬
2. **å•é¡Œè‡ªå‹•æª¢æ¸¬**ï¼šæ–‡å­—æº¢å‡ºã€å½¢ç‹€é‡ç–Šã€æ ¼å¼è­¦å‘Š
3. **ç¯„æœ¬é‡ç”¨æ”¯æ´**ï¼šå®Œæ•´çš„å·¥ä½œæµç¨‹å¾åˆ†æåˆ°ç”Ÿæˆ
4. **è¨­è¨ˆæŒ‡å¼•**ï¼šé¿å… AI é¢¨æ ¼ï¼Œé¼“å‹µå…§å®¹æ„ŸçŸ¥è¨­è¨ˆ
5. **æ‰¹æ¬¡è™•ç†**ï¼šé©åˆé‡è¤‡æ€§ç°¡å ±è£½ä½œ

### å­¸ç¿’é‡é»

å°æ–¼æƒ³è¦ç†è§£æ­¤ Skill çš„é–‹ç™¼è€…ï¼š
- OOXML ç°¡å ±çµæ§‹
- ç¾¤çµ„å½¢ç‹€çš„çµ•å°ä½ç½®è¨ˆç®—
- æ–‡å­—æº¢å‡ºä¼°ç®—ï¼ˆæ–‡å­—æ¸¬é‡ã€æ›è¡Œã€è¡Œè·ï¼‰
- å½¢ç‹€é‡ç–Šæª¢æ¸¬æ¼”ç®—æ³•
- æŠ•å½±ç‰‡è¤‡è£½çš„åœ–ç‰‡é—œä¿‚è™•ç†
- è¦–è¦ºä½ç½®æ’åºç­–ç•¥

### é©ç”¨å ´æ™¯

æ­¤ Skill æœ€é©åˆç”¨æ–¼ï¼š
- ğŸ“Š æ•¸æ“šå ±å‘Šç°¡å ±ï¼ˆæœˆå ±ã€å­£å ±ã€å¹´å ±ï¼‰
- ğŸ¯ éŠ·å”®ææ¡ˆå’Œç”¢å“ç™¼è¡¨
- ğŸ“š æ•™è‚²è¨“ç·´æ•™æ
- ğŸ¢ å…¬å¸å…§éƒ¨æºé€šç°¡å ±
- ğŸ¨ åŸºæ–¼ç¯„æœ¬çš„å“ç‰Œç°¡å ±
- ğŸ“ˆ å®šæœŸæ›´æ–°çš„å„€è¡¨æ¿ç°¡å ±

### æŠ€è¡“äº®é»

- **ç¾¤çµ„å½¢ç‹€è™•ç†**ï¼šæ­£ç¢ºè¨ˆç®—ä»»æ„æ·±åº¦åµŒå¥—çš„å½¢ç‹€ä½ç½®
- **æ–‡å­—æº¢å‡ºä¼°ç®—**ï¼šä½¿ç”¨ PIL ç²¾ç¢ºæ¸¬é‡æ–‡å­—é«˜åº¦
- **è¦–è¦ºé©—è­‰**ï¼šç¸®åœ–ç¶²æ ¼å’Œå ä½ç¬¦æ¨™ç¤º
- **æ‰¹æ¬¡å‹å¥½**ï¼šæ¨¡æ¿åŒ–æ˜ å°„å’Œè‡ªå‹•åŒ–æ›¿æ›
- **å•é¡Œå°å‘**ï¼š`--issues-only` æ¨™è¨˜åªé¡¯ç¤ºéœ€è¦é—œæ³¨çš„éƒ¨åˆ†

---

## åƒè€ƒè³‡æº

- [SKILL.md](./SKILL.md) - è‹±æ–‡åŸå§‹æ–‡æª”
- [html2pptx.md](./html2pptx.md) - html2pptx å·¥ä½œæµç¨‹æŒ‡å—
- [ooxml.md](./ooxml.md) - OOXML æ“ä½œè©³ç´°æ–‡æª”
- [python-pptx æ–‡æª”](https://python-pptx.readthedocs.io/)
- [PptxGenJS æ–‡æª”](https://gitbrent.github.io/PptxGenJS/)

---

**æœ€å¾Œæ›´æ–°**ï¼š2025-11-14
**æ–‡ä»¶ç‰ˆæœ¬**ï¼š1.0.0
**é©ç”¨æ–¼**ï¼šClaude Code Skills
